<!DOCTYPE html>
<html lang="en-US">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Retrieving SSL Certificate Information With Python</title>
  <meta name="description" content="Retrieving SSL Certificate Information With Python">
  <link rel="canonical" href="http://localhost:4000/retrieving-ssl-certificate-info">
  <link rel="alternate" type="application/rss+xml" title="joshuack.cloud Feed"
    href="http://localhost:4000/feed.xml">
  
  <link rel="shortcut icon" href="/images/favicon.png" type="image/png" />
  
  <!-- Styles -->
  <link href="https://fonts.googleapis.com/css?family=Lato:400,400i,700,700i%7CNoto+Serif:400,400i,700,700i&display=swap" rel="stylesheet">
  <link href="/assets/css/style.css" rel="stylesheet">
</head>
<body>

  <div id="page" class="site">
    <div class="inner">
      <header class="site-header">
  
  <p class="site-title"><a class="logo-text" href="/">joshuack.cloud</a></p>
  
  <nav class="site-navigation">
    <div class="site-navigation-wrap">
      <h2 class="screen-reader-text">Main navigation</h2>
      <ul class="menu">
        
        
        
        <li class="menu-item ">
          <a class="" href="/">Home</a>
        </li>
        
        
        
        <li class="menu-item ">
          <a class="" href="/tags/">Tags</a>
        </li>
        
      </ul><!-- .menu -->
      <button id="menu-close" class="menu-toggle"><span class="screen-reader-text">Close Menu</span><span
          class="icon-close" aria-hidden="true"></span></button>
    </div><!-- .site-navigation-wrap -->
  </nav><!-- .site-navigation -->
  <button id="menu-open" class="menu-toggle"><span class="screen-reader-text">Open Menu</span><span class="icon-menu" aria-hidden="true"></span></button>
</header>


      <main class="main-content fadeInDown delay_075s">

  <article class="post">
    <header class="post-header">
      <time class="post-date" datetime="2024-02-01">February 1, 2024</time>
      <h1 class="post-title">Retrieving SSL Certificate Information With Python</h1>
      <div class="post-meta">
        By <span class="post-author">Joshua</span><span class="post-tags"> in <a href="/tags/#Scripting" rel="tag">Scripting</a>, <a href="/tags/#Python" rel="tag">Python</a>, <a href="/tags/#SSL" rel="tag">SSL</a></span>
      </div><!-- .post-meta -->
      
    </header><!-- .post-header -->
    <div class="post-content">
      <p>If you’re building or supporting a live service, SSL certificates and and their management will no doubt be something you find yourself involved with at some stage. Whilst in the modern cloud landscape there is a vast array of tooling for monitoring and managing the life cycle of SSL certificates. There may come a time when a slightly more primitive solution is the one that works best.</p>

<p>This post provides some detail on how to monitor SSL certificates using a small but helpful Python program.</p>

<p>We’ll look at creating the script itself, or if you would prefer to just retrieve a copy you can do so via GitHub <span style="color:blue"><a href="https://github.com/Joshua-K1/py-ssl-check">here.</a></span></p>

<!--more-->

<h2 id="check-if-python-is-installed">Check if Python is installed</h2>
<p>First, we need to check that the machine we are using has Python installed. This post will focus on the use of Python3 so each of the commands will include the <code class="language-plaintext highlighter-rouge">python3</code> notation.</p>

<h3 id="mac">Mac</h3>
<p>Open a shell prompt, such as <code class="language-plaintext highlighter-rouge">Terminal</code> or <code class="language-plaintext highlighter-rouge">item2</code> and run the below command.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">python3</span> <span class="o">--</span><span class="nx">version</span>
</code></pre></div></div>
<p>If the system has Python installed, the output will look as below.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Python 3.x.x
</code></pre></div></div>
<p>If nothing, or an error message stating Python cannot be found is returned. Then you need to install it.</p>

<p><strong>Install Via the Python Website</strong></p>

<p>Visit the <a href="https://www.python.org/downloads/macos/">Python Website</a> and download the latest or required stable release. Once downloaded, locate and run the <code class="language-plaintext highlighter-rouge">.pkg</code> file. Once ran, follow the installer instructions until completed.</p>

<p><strong>Install via Homebrew</strong></p>

<p>Homebrew is a package manager for MacOS and Linux. Similar to APT and YUM, Homebrew provides a straightforward package management experience. For instructions on how to install Homebrew, visit their website <span style="color:blue"><a href="https://brew.sh/">here.</a></span></p>

<p>To install Python via Homebrew, run the below command:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">brew</span> <span class="nx">install</span> <span class="nx">python3</span>
</code></pre></div></div>

<p>Once installed, you can again verify the installation by running the below command in shell prompt:</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">python3</span> <span class="o">--</span><span class="nx">version</span>
</code></pre></div></div>

<h2 id="creating-the-script">Creating the script</h2>
<p>Navigate to a directory of your chooisng and create a file called ssl-check.py.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>cd ~/repositories
touch ssl-check.py
</code></pre></div></div>

<p>Once created, open the file in your preffered text editor and at the very top of the file add the below statements to import the libraries required by the script.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">import</span> <span class="nx">ssl</span><span class="p">,</span> <span class="nx">socket</span> <span class="err">#</span> <span class="nx">Allows</span> <span class="nx">us</span> <span class="nx">to</span> <span class="nx">make</span> <span class="nx">SSL</span> <span class="nx">connections</span> <span class="nx">to</span> <span class="nx">an</span> <span class="nx">endpoint</span>
<span class="k">from</span> <span class="nx">datetime</span> <span class="k">import</span> <span class="nx">date</span> <span class="err">#</span> <span class="nx">Allows</span> <span class="nx">us</span> <span class="nx">to</span> <span class="nx">manipulate</span> <span class="nx">date</span> <span class="nx">objects</span>
<span class="k">from</span> <span class="nx">dateutil</span> <span class="k">import</span> <span class="nx">parser</span> <span class="err">#</span> <span class="nx">Allows</span> <span class="nx">us</span> <span class="nx">to</span> <span class="nx">parse</span> <span class="nx">date</span> <span class="nx">objects</span> <span class="nx">into</span> <span class="nx">strings</span> 
<span class="k">from</span> <span class="nx">prettytable</span> <span class="k">import</span> <span class="nx">PrettyTable</span> <span class="err">#</span> <span class="nx">Allows</span> <span class="nx">us</span> <span class="nx">to</span> <span class="nx">generate</span> <span class="nx">formatted</span> <span class="nx">tables</span>
</code></pre></div></div>

<p>Next, we define 3 separate arrays.</p>
<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">domains</span> <span class="o">=</span> <span class="p">[</span><span class="dl">"</span><span class="s2">google.com, youtube.com</span><span class="dl">"</span><span class="p">]</span> <span class="err">#</span> <span class="nx">Stores</span> <span class="nx">the</span> <span class="nx">domains</span> <span class="nx">we</span> <span class="nx">will</span> <span class="nx">test</span>
<span class="nx">alt_domains</span> <span class="o">=</span> <span class="p">[]</span> <span class="err">#</span> <span class="nx">Stores</span> <span class="nx">the</span> <span class="nx">certificate</span> <span class="nx">SAN</span> <span class="nx">names</span>
<span class="nx">crts</span> <span class="o">=</span> <span class="p">[]</span> <span class="err">#</span> <span class="nx">Stores</span> <span class="nx">crt</span> <span class="nx">objects</span>
</code></pre></div></div>

<p>In the above code, the domains array has been populated with the <code class="language-plaintext highlighter-rouge">google.com</code> and <code class="language-plaintext highlighter-rouge">youtube.com</code> domains. Replace these with the domains which you need to test. These can be anything that has a HTPS service housing a certificate and anything that is resolvable by DNS.</p>

<p>Next we define a Certificate class. For each domain tested, we will generate an object of the Certificate class which will store the pieces of information we retrieve.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="kd">class</span> <span class="nc">Certificate</span><span class="p">:</span>
    <span class="nx">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="nb">self</span><span class="p">,</span> <span class="nx">name</span><span class="p">,</span> <span class="nx">san</span><span class="p">,</span> <span class="nx">expire</span><span class="p">,</span> <span class="nx">days_left</span><span class="p">,</span> <span class="nx">common_name</span><span class="p">):</span>
        <span class="nb">self</span><span class="p">.</span><span class="nx">name</span> <span class="o">=</span> <span class="nx">name</span>
        <span class="nb">self</span><span class="p">.</span><span class="nx">san</span> <span class="o">=</span> <span class="nx">san</span>
        <span class="nb">self</span><span class="p">.</span><span class="nx">expire</span> <span class="o">=</span> <span class="nx">expire</span>
        <span class="nb">self</span><span class="p">.</span><span class="nx">days_left</span> <span class="o">=</span> <span class="nx">days_left</span>
        <span class="nb">self</span><span class="p">.</span><span class="nx">common_name</span> <span class="o">=</span> <span class="nx">common_name</span>
</code></pre></div></div>

<p>Next, we define our main function which houses a loop to iterate through the <code class="language-plaintext highlighter-rouge">domains</code> arrray and retrieve the certificate information of each domain held in the array.</p>

<div class="language-javascript highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nx">def</span> <span class="nf">main</span><span class="p">():</span>
    <span class="err">#</span> <span class="k">for</span> <span class="nx">each</span> <span class="nx">value</span> <span class="k">in</span> <span class="nx">domains</span>
    <span class="k">for</span> <span class="nx">domain</span> <span class="k">in</span> <span class="nx">domains</span><span class="p">:</span>

        <span class="err">#</span> <span class="nx">define</span> <span class="nx">the</span> <span class="nx">SSL</span> <span class="nx">session</span> <span class="nx">context</span>
        <span class="err">#</span> <span class="k">this</span> <span class="nx">is</span> <span class="nx">a</span> <span class="nx">helper</span> <span class="kd">function</span> <span class="nf">provided</span>
        <span class="err">#</span> <span class="nx">by</span> <span class="nx">the</span> <span class="nx">ssl</span> <span class="nx">library</span> <span class="nx">to</span> <span class="kd">set</span> <span class="nx">secure</span>
        <span class="err">#</span> <span class="k">default</span> <span class="nx">settings</span><span class="p">.</span>
        <span class="nx">ctx</span> <span class="o">=</span> <span class="nx">ssl</span><span class="p">.</span><span class="nf">create_default_context</span><span class="p">()</span>

		<span class="err">#</span> <span class="nx">create</span> <span class="nx">an</span> <span class="nx">SSL</span> <span class="nx">sockect</span> <span class="nx">and</span> <span class="nx">associate</span>
		<span class="err">#</span> <span class="nx">it</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nf">ctx </span><span class="p">(</span><span class="nx">context</span><span class="p">)</span>
        <span class="kd">with</span> <span class="nx">ctx</span><span class="p">.</span><span class="nf">wrap_socket</span><span class="p">(</span><span class="nx">socket</span><span class="p">.</span><span class="nf">socket</span><span class="p">(),</span> <span class="nx">server_hostname</span><span class="o">=</span><span class="nx">domain</span><span class="p">)</span> <span class="k">as</span> <span class="nx">soc</span><span class="p">:</span>

			<span class="err">#</span> <span class="nx">open</span> <span class="nx">connection</span> <span class="nx">on</span> <span class="nx">port</span> 
			<span class="err">#</span> <span class="mi">443</span> <span class="kd">with</span> <span class="nx">the</span> <span class="nx">domain</span> <span class="nx">held</span> 
			<span class="err">#</span> <span class="k">in</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">loop</span> 
			<span class="err">#</span> <span class="nx">iteration</span>
            <span class="nx">soc</span><span class="p">.</span><span class="nf">connect</span><span class="p">((</span><span class="nx">domain</span><span class="p">,</span> <span class="mi">443</span><span class="p">))</span>

			<span class="err">#</span> <span class="nx">uses</span> <span class="nx">socket</span> <span class="nx">helper</span> <span class="kd">function</span>
			<span class="err">#</span> <span class="nf">getpeercert</span><span class="p">()</span> <span class="nx">to</span> <span class="nx">retrieve</span> 
			<span class="err">#</span> <span class="nx">SSL</span> <span class="nx">certificate</span>
            <span class="nx">cert</span> <span class="o">=</span> <span class="nx">soc</span><span class="p">.</span><span class="nf">getpeercert</span><span class="p">()</span>

            <span class="err">#</span> <span class="nx">create</span> <span class="nx">a</span> <span class="nx">dictionary</span> <span class="nx">object</span> <span class="nx">to</span> <span class="nx">unpack</span>
            <span class="err">#</span> <span class="nx">values</span> <span class="nx">returned</span>
            <span class="nx">certificate_domains</span> <span class="o">=</span> <span class="nf">dict</span><span class="p">(</span><span class="nx">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="k">for</span> <span class="nx">x</span> <span class="k">in</span> <span class="nx">cert</span><span class="p">[</span><span class="dl">'</span><span class="s1">subject</span><span class="dl">'</span><span class="p">])</span>

			<span class="err">#</span> <span class="nx">create</span> <span class="nx">a</span> <span class="kd">var</span> <span class="nx">to</span> <span class="nx">hold</span> <span class="nx">the</span> <span class="nx">Common</span> <span class="nx">Name</span> 
			<span class="err">#</span> <span class="nx">value</span> <span class="nx">returned</span>
            <span class="nx">issued_to</span> <span class="o">=</span> <span class="nx">certificate_domains</span><span class="p">[</span><span class="dl">'</span><span class="s1">commonName</span><span class="dl">'</span><span class="p">]</span>

			<span class="err">#</span> <span class="nx">create</span> <span class="nx">an</span> <span class="nx">array</span> <span class="nx">to</span> <span class="nx">hold</span> <span class="nx">the</span> <span class="nx">SAN</span> <span class="nx">domains</span>
			<span class="err">#</span> <span class="k">as</span> <span class="nx">there</span> <span class="nx">are</span> <span class="nx">a</span> <span class="nx">number</span> <span class="k">of</span> <span class="nx">SANs</span> <span class="nx">per</span> <span class="nx">cert</span><span class="p">,</span> 
			<span class="err">#</span> <span class="nx">these</span> <span class="nx">are</span> <span class="nx">returned</span> <span class="k">as</span> <span class="nx">an</span> <span class="nx">array</span> <span class="k">from</span> <span class="nx">the</span> <span class="nx">dict</span>
            <span class="nx">certificate_alt_domain</span> <span class="o">=</span> <span class="nx">cert</span><span class="p">[</span><span class="dl">'</span><span class="s1">subjectAltName</span><span class="dl">'</span><span class="p">]</span>

			<span class="err">#</span> <span class="nx">create</span> <span class="nx">an</span> <span class="nx">empty</span> <span class="nx">array</span> <span class="nx">to</span> <span class="nx">store</span>
			<span class="err">#</span> <span class="nx">alt</span> <span class="nx">domain</span> <span class="k">as</span> <span class="nx">it</span> <span class="nx">is</span> <span class="nx">retrieved</span>
            <span class="nx">x</span> <span class="o">=</span> <span class="p">[]</span>
            <span class="k">for</span> <span class="nx">alt_domain</span> <span class="k">in</span> <span class="nx">certificate_alt_domain</span><span class="p">:</span>
                <span class="nx">alt_domain_lower</span> <span class="o">=</span> <span class="nx">alt_domain</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
                <span class="nx">x</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nx">alt_domain_lower</span><span class="p">)</span>

			<span class="err"># </span><span class="nx">retrieve</span> <span class="nx">the</span> <span class="nx">expiration</span> <span class="nx">date</span> <span class="nx">and</span> 
			<span class="err">#</span> <span class="nx">parse</span> <span class="nx">into</span> <span class="nx">a</span> <span class="nx">legible</span> <span class="nx">format</span>
            <span class="nx">res</span> <span class="o">=</span> <span class="nx">parser</span><span class="p">.</span><span class="nf">parse</span><span class="p">(</span><span class="nx">cert</span><span class="p">[</span><span class="dl">'</span><span class="s1">notAfter</span><span class="dl">'</span><span class="p">],</span> <span class="nx">fuzzy</span><span class="o">=</span><span class="nx">True</span><span class="p">)</span>

			<span class="err">#</span> <span class="nx">retrieve</span> <span class="nx">the</span> <span class="nx">current</span> <span class="nx">date</span>
            <span class="nx">current_date</span> <span class="o">=</span> <span class="nx">date</span><span class="p">.</span><span class="nf">today</span><span class="p">()</span>
            
            <span class="err">#</span> <span class="nx">minus</span> <span class="nx">the</span> <span class="nx">currne</span> <span class="nx">date</span> <span class="k">from</span> <span class="nx">the</span> 
            <span class="err">#</span> <span class="nx">expiration</span> <span class="nx">date</span> <span class="nx">and</span> <span class="nx">store</span> <span class="k">as</span> 
            <span class="err">#</span> <span class="nx">days</span> <span class="nx">left</span>
            <span class="nx">days_left</span><span class="o">=</span><span class="p">(</span><span class="nx">res</span><span class="p">.</span><span class="nf">date</span><span class="p">()</span><span class="o">-</span><span class="nx">current_date</span><span class="p">).</span><span class="nx">days</span>

			<span class="err">#</span> <span class="nx">create</span> <span class="nx">an</span> <span class="nf">object </span><span class="p">(</span><span class="nx">crt</span><span class="p">)</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">Certificate</span> <span class="kd">class</span> 
			<span class="err"># </span><span class="nc">with</span> <span class="nx">the</span> <span class="nx">values</span> <span class="nx">retrieved</span>
            <span class="nx">crt</span> <span class="o">=</span> <span class="nc">Certificate</span><span class="p">(</span><span class="nx">domain</span><span class="p">,</span> <span class="nx">x</span><span class="p">,</span> <span class="nx">res</span><span class="p">.</span><span class="nf">date</span><span class="p">(),</span> <span class="nx">days_left</span><span class="p">,</span> <span class="nx">issued_to</span><span class="p">)</span>

			<span class="err">#</span> <span class="nx">append</span> <span class="nx">crt</span> <span class="nx">object</span> <span class="nx">to</span> <span class="nx">crts</span> <span class="nx">array</span>
            <span class="nx">crts</span><span class="p">.</span><span class="nf">append</span><span class="p">(</span><span class="nx">crt</span><span class="p">)</span>

	<span class="err">#</span> <span class="nx">loop</span> <span class="nx">through</span> <span class="nx">each</span> <span class="nx">crt</span>
	<span class="err">#</span> <span class="nx">object</span> <span class="k">in</span> <span class="nx">crts</span> <span class="nx">array</span>
    <span class="k">for</span> <span class="nx">crt</span> <span class="k">in</span> <span class="nx">crts</span><span class="p">:</span>

        <span class="err">#</span> <span class="nx">create</span> <span class="nx">a</span> <span class="nx">table</span> <span class="nx">using</span> <span class="nx">the</span> <span class="nx">PrettyTable</span> <span class="nx">libray</span> <span class="kd">with</span> <span class="nx">the</span> 
        <span class="err">#</span> <span class="nx">Name</span><span class="p">,</span> <span class="nx">Common</span> <span class="nx">Name</span><span class="p">,</span> <span class="nx">Expiration</span> <span class="nx">and</span> <span class="nx">Days</span> <span class="nx">Left</span> <span class="nx">headers</span>
        <span class="nx">t</span> <span class="o">=</span> <span class="nc">PrettyTable</span><span class="p">([</span><span class="dl">'</span><span class="s1">Name</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Common Name</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Expiration</span><span class="dl">'</span><span class="p">,</span> <span class="dl">'</span><span class="s1">Days Left</span><span class="dl">'</span><span class="p">])</span>

		<span class="err">#</span> <span class="nx">add</span> <span class="nx">the</span> <span class="nx">values</span> <span class="k">of</span> <span class="nx">the</span> <span class="nx">crt</span> <span class="nx">object</span> <span class="k">as</span> <span class="nx">a</span> <span class="nx">table</span> <span class="nx">row</span>
        <span class="nx">t</span><span class="p">.</span><span class="nf">add_row</span><span class="p">([</span><span class="nx">crt</span><span class="p">.</span><span class="nx">name</span><span class="p">,</span> <span class="nx">crt</span><span class="p">.</span><span class="nx">common_name</span><span class="p">,</span> <span class="nx">crt</span><span class="p">.</span><span class="nx">expire</span><span class="p">,</span> <span class="nx">crt</span><span class="p">.</span><span class="nx">days_left</span><span class="p">])</span>

		<span class="err">#</span> <span class="nx">store</span> <span class="nx">the</span> <span class="nx">array</span> <span class="nx">returned</span>
		<span class="err">#</span> <span class="k">from</span> <span class="nx">crt</span><span class="p">.</span><span class="nx">san</span> <span class="k">as</span> <span class="nx">x</span>
        <span class="nx">x</span> <span class="o">=</span> <span class="nx">crt</span><span class="p">.</span><span class="nx">san</span>

		<span class="err">#</span> <span class="nx">create</span> <span class="nx">a</span> <span class="k">new</span> <span class="nx">table</span> <span class="kd">with</span> <span class="nx">the</span> 
		<span class="err">#</span> <span class="nx">heading</span> <span class="nx">SANs</span>
        <span class="nx">t_s</span> <span class="o">=</span> <span class="nc">PrettyTable</span><span class="p">([</span><span class="dl">'</span><span class="s1">SANs</span><span class="dl">'</span><span class="p">])</span>
        
        <span class="err">#</span> <span class="k">for</span> <span class="nx">each</span> <span class="nx">value</span> <span class="k">in</span> <span class="nx">x</span> <span class="nx">array</span>
        <span class="err">#</span> <span class="nx">add</span> <span class="k">as</span> <span class="nx">a</span> <span class="nx">row</span> <span class="nx">to</span> <span class="nx">table</span> 
        <span class="k">for</span> <span class="nx">d</span> <span class="k">in</span> <span class="nx">x</span><span class="p">:</span>
            <span class="nx">t_s</span><span class="p">.</span><span class="nf">add_row</span><span class="p">([</span><span class="nx">d</span><span class="p">])</span>

		<span class="err">#</span> <span class="nx">print</span> <span class="nx">table</span> <span class="nx">t</span>
        <span class="nf">print</span><span class="p">(</span><span class="nx">t</span><span class="p">)</span>

		<span class="err">#</span> <span class="nx">print</span> <span class="nx">table</span> <span class="nx">t_s</span>
        <span class="nf">print</span><span class="p">(</span><span class="nx">t_s</span><span class="p">)</span>

<span class="k">if</span> <span class="nx">__name__</span> <span class="o">==</span> <span class="dl">"</span><span class="s2">__main__</span><span class="dl">"</span><span class="p">:</span>
    <span class="nf">main</span><span class="p">()</span>
</code></pre></div></div>

<p>Once the above has been added, the script is completed and can be ran with the below command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python3 ssl-check.py
</code></pre></div></div>

<p>If you see an error such as the below, the libraries required by the script are missing.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>Traceback (most recent call last):
  File "/home/leenux/repos/py-ssl-check/py_ssl.py", line 3, in &lt;module&gt;
    from dateutil import parser
ModuleNotFoundError: No module named 'dateutil'
</code></pre></div></div>

<p>To import the required libraries, create a new file called <code class="language-plaintext highlighter-rouge">requirements.txt</code> within the same directoy and within it add the below lines:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>prettytable==3.8.0
python-dateutil==2.8.2
</code></pre></div></div>

<p>Once added, run the below command:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>pip install -r requirements.txt
</code></pre></div></div>

<p>This file is also available within the repository <span style="color:blue"><a href="https://github.com/Joshua-K1/py-ssl-check/blob/main/py_ssl.py">here</a></span></p>

<p>Now, when running the script the output should look as below:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>+------------+--------------+------------+-----------+
|    Name    | Common Name  | Expiration | Days Left |
+------------+--------------+------------+-----------+
| google.com | *.google.com | 2023-10-09 |     54    |
+------------+--------------+------------+-----------+
+--------------------------------------+
|                 SANs                 |
+--------------------------------------+
|             *.google.com             |
|        *.appengine.google.com        |
|              *.bdn.dev               |
|        *.origin-test.bdn.dev         |
|          *.cloud.google.com          |
|       *.crowdsource.google.com       |
|       *.datacompute.google.com       |
|             *.google.ca              |
|             *.google.cl              |
|            *.google.co.in            |
|            *.google.co.jp            |
				
</code></pre></div></div>

    </div><!-- .post-content -->
    <div class="post-share">
      <span>Share:</span>
      <a target="_blank"
        href="https://twitter.com/intent/tweet?text=Retrieving%20SSL%20Certificate%20Information%20With%20Python&amp;url=http://localhost:4000/retrieving-ssl-certificate-info" rel="noopener">Twitter</a>
      <a target="_blank"
        href="https://www.facebook.com/sharer/sharer.php?u=http://localhost:4000/retrieving-ssl-certificate-info&amp;t=Retrieving%20SSL%20Certificate%20Information%20With%20Python" rel="noopener">Facebook</a>
    </div><!-- .share-post -->
    <div class="author-box">
      
      <div class="author-details">
        <h2 class="author-title">About Joshua</h2>
        <div class="author-bio"><p>Joshua is a Platform Engineer based in Ireland</p>
</div>
        
        
      </div><!-- .author-details -->
    </div><!-- .author-box -->
  </article><!-- .post -->

  

</main><!-- .main-content -->
      <footer class="site-footer">
  <div class="offsite-links">
    
      
<a href="https://twitter.com/iJoshuaCK" target="_blank" rel="noopener">
  <span class="fa-twitter" aria-hidden="true"></span>
  <span class="screen-reader-text">Twitter</span>
</a>

<a href="https://github.com/Joshua-K1" target="_blank" rel="noopener">
  <span class="fa-github" aria-hidden="true"></span>
  <span class="screen-reader-text">GitHub</span>
</a>

    
  </div><!-- .offsite-links -->
  <div class="footer-bottom">
    <div class="site-info">
      

    </div><!-- .site-info -->
    <a href="#page" id="back-to-top" class="back-to-top"><span class="screen-reader-text">Back to the top </span>&#8593;</a>
  </div><!-- .footer-bottom -->
</footer><!-- .site-footer -->

    </div><!-- .inner -->
  </div><!-- .site -->

  <!-- Scripts -->
  
    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','https://www.google-analytics.com/analytics.js','ga');

  ga('create', '', 'auto');
  ga('send', 'pageview');
</script>
  
  <script src="/assets/js/plugins.js"></script>
  <script src="/assets/js/custom.js"></script>

</body>
</html>